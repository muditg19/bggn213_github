<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Mudit (PID: 911)">

<title>Class7: Machine Learning 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Class7_files/libs/clipboard/clipboard.min.js"></script>
<script src="Class7_files/libs/quarto-html/quarto.js"></script>
<script src="Class7_files/libs/quarto-html/popper.min.js"></script>
<script src="Class7_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Class7_files/libs/quarto-html/anchor.min.js"></script>
<link href="Class7_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Class7_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Class7_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Class7_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Class7_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Class7: Machine Learning 1</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Mudit (PID: 911) </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>Before we get into clustering methods, let’s make some sample to cluster where we know what the answer should be.</p>
<p>To help whith this I will use the <code>rnorm()</code> function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rnorm</span>(<span class="dv">1500000</span>, <span class="at">mean =</span> <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class7_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">15000</span>, <span class="at">mean =</span> <span class="sc">-</span><span class="dv">3</span>), <span class="fu">rnorm</span>(<span class="dv">15000</span>, <span class="at">mean =</span> <span class="dv">3</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class7_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rnorm</span>(<span class="dv">15000</span>, <span class="at">mean =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class7_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="sc">-</span><span class="dv">3</span>), <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] -2.51827517 -2.25222170 -2.11606201 -3.81799912 -1.53714201 -2.10120447
   [7] -2.54128338 -1.12659742 -3.64658138 -3.92495723 -2.77732893 -4.08155042
  [13] -2.53878039 -2.69367537 -2.44182818 -1.99858127 -2.45469346 -2.93277184
  [19] -2.56344040 -1.19384775 -0.85944733 -2.88384694 -2.76550262 -2.68738998
  [25] -5.07995366 -3.50994688 -1.88838573 -4.19380779 -2.92956640 -2.54582474
  [31] -4.47189215 -1.09142009 -2.54042250 -1.49423922 -4.70640457 -2.34284402
  [37] -2.67915484 -2.61786124 -2.72226960 -3.66845909 -3.83233268 -0.51161912
  [43] -5.43977583 -3.18285356 -1.97806476 -3.53789369 -3.17020037 -3.11251911
  [49] -3.35030915 -1.14687006 -1.95757886 -3.86227982 -3.03313711 -2.07419375
  [55] -2.41816479 -2.59446932 -1.96638743 -2.40818478 -2.46764511 -3.23704826
  [61] -3.54581416 -2.63298878 -3.27910053 -0.54648622 -1.86155588 -2.41891816
  [67] -4.40683416 -3.12946455 -2.75053898 -2.58356292 -1.73901373 -4.76041922
  [73] -2.59060387 -3.74544358 -3.92733046 -2.25124415 -3.72833941 -4.51789473
  [79] -3.14427914 -3.51449631 -3.67776330 -2.17620313 -2.11707868 -2.54595099
  [85] -0.75732154 -2.92909090 -3.77108160 -2.82175829 -1.70551710 -4.32142664
  [91] -1.96891727 -2.41418826 -3.62441521 -1.06568519 -2.89564150 -1.58725337
  [97] -1.78855034 -1.97612215 -3.12554351 -2.65746835 -4.53037777 -2.54733440
 [103] -2.30975554 -2.99741845 -3.66201669 -3.45749942 -4.89178839 -3.70049464
 [109] -3.83420783 -2.88373795 -2.68000747 -3.67244622 -4.63203094 -2.94662598
 [115] -2.06068330 -2.91037558 -2.47794058 -3.15706464 -2.68028439 -4.06239779
 [121] -4.29893781 -3.54298441 -1.87232599 -1.87883018 -2.48643559 -3.95289341
 [127] -3.00738423 -3.71394639 -2.10058619 -1.57912411 -2.31220524 -4.56345309
 [133] -3.70176234 -2.29506245 -1.48339984 -4.02149383 -2.60289311 -3.57890059
 [139] -1.56112178 -4.44975243 -2.13911052 -4.41894950 -5.69234442 -4.41160956
 [145] -2.45478095 -1.22119902 -2.24374664 -3.19942101 -4.57282784 -1.22264763
 [151] -3.30448524 -3.36511132 -2.12980543 -2.54253776 -4.21918005 -2.98790323
 [157] -4.33388503 -3.82204801 -1.41142734 -1.11123551 -4.24946931 -3.46682626
 [163] -3.48100341 -1.85428233 -3.72003820 -2.67490280 -4.00416972 -3.24031344
 [169] -1.07672866 -2.31716131 -3.56610158 -3.74907229 -2.55620713 -3.82312687
 [175] -0.38817184 -3.14255275 -4.33099454 -2.21246729 -2.64112778 -3.40204694
 [181] -2.61534526 -1.98457055 -1.51652670 -3.41776137 -3.18884427 -2.17905493
 [187] -1.60756513 -2.87631264 -5.17093990 -4.77959423 -3.36796100 -1.30484247
 [193] -2.46672031 -1.55856429 -2.14430668 -3.84661560 -4.08350129 -2.26655488
 [199] -0.86562366 -2.53382093 -2.38809588 -1.99826476 -1.91646027 -2.81989565
 [205] -4.07912286 -2.82949323 -2.30462333 -4.62629072 -3.01695884 -3.78600114
 [211] -1.48749217 -3.06564862 -2.39583427 -4.33318153 -1.27760400 -2.71726612
 [217] -2.99659544 -3.56669229 -4.19420239 -0.90184342 -3.62962912 -3.13089619
 [223] -2.92939253 -2.83444258 -3.52783430 -0.02341123 -3.19871728 -3.97104053
 [229] -3.79743617 -4.39678888 -1.78400820 -2.35968901 -1.65795639 -1.72981586
 [235] -2.61185466 -3.40827951 -3.72525459 -2.68918916 -4.71635354 -2.54305011
 [241] -4.78973750 -1.58736101 -3.35319355 -3.18551843 -3.04486823 -2.26766863
 [247] -3.37651714 -3.44061393 -2.36767506 -2.35137416 -3.45732937 -3.12138110
 [253] -2.04258725 -3.67573313 -2.50442002 -4.28377092 -2.38774144 -2.85218711
 [259] -4.30790233 -0.91935141 -5.25716793 -3.04963252 -3.47562580 -1.84496913
 [265] -3.20488589 -3.42027679 -2.04634365 -2.53971563 -2.39463103 -2.02981315
 [271] -2.17468634 -3.57128424 -0.49063455 -6.05764098 -1.84642733 -3.78541429
 [277] -4.57368989 -2.48304277 -3.03730007 -2.91709502 -1.06989622 -1.57689262
 [283] -3.07560115 -2.51989627 -1.09522061 -2.02270808 -3.65283272 -4.40813960
 [289] -5.72910969 -3.52982116 -3.30475627 -3.79333727 -2.83329287 -3.33067810
 [295] -3.55371922 -0.94685444 -1.21198655 -3.90875479 -1.50092885 -3.67594645
 [301] -3.59741177 -3.23908037 -2.26065060 -2.64458917 -2.71540906 -2.99335246
 [307] -3.09882393 -3.00682399 -2.21718007 -3.74067931 -3.53747707 -4.25971220
 [313] -2.65617161 -3.72286721 -3.95008085 -3.54115319 -2.75441516 -3.26883730
 [319] -4.72023184 -1.62017035 -5.24062572 -4.12519924 -2.86282933 -2.93661661
 [325] -2.90468460 -2.61736204 -4.31752656 -2.01933311 -2.23662338 -2.76818923
 [331] -1.44149785 -2.40743658 -4.20379291 -3.47495243 -3.26464445 -1.34215069
 [337] -1.74646327 -3.38111835 -3.62731190 -1.49969233 -1.69692892 -2.17435038
 [343] -2.39964356 -1.91617392 -3.32005363 -2.79048095 -1.31651755 -4.43744205
 [349] -4.27035594 -2.08603901 -3.60724419 -1.88977568 -3.02703942 -1.83707119
 [355] -1.77652427 -3.01374093 -1.08272767 -1.76742447 -2.77146357 -2.87297813
 [361] -4.14301643 -2.86213616 -2.49994869 -2.65848303 -2.88762551 -3.04462598
 [367] -3.34388339 -4.36177577 -2.28871314 -1.97917023 -2.67827823 -2.27454617
 [373] -3.94844657 -1.75784528 -0.95993005 -3.43370297 -3.63217191 -3.99541883
 [379] -1.71107127 -3.46253020 -2.80112377 -4.41769802 -3.91629509 -2.41517382
 [385] -4.21169850 -1.95699273 -2.14421150 -5.34625642 -3.69268597 -4.13979429
 [391] -3.27101476 -3.48987636 -1.77055189 -2.05663944 -2.50212847 -2.06147310
 [397] -4.00226149 -2.84789862 -1.90647749 -2.17127475 -3.59345693 -1.42588506
 [403] -3.10114123 -3.63802916 -3.56117071 -2.30215690 -1.98630568 -1.36712146
 [409] -3.14421744 -1.43191617 -3.57463897 -2.14696294 -2.60669040 -4.10536815
 [415] -2.38503490 -1.27674144 -3.32977191 -1.61068894 -3.39324389 -3.24090125
 [421] -2.62547226 -1.67022173 -2.93043648 -2.58293259 -3.39801357 -3.09981318
 [427] -3.71232250 -4.57023085 -2.19163685 -0.72017790 -4.11212363 -2.64447316
 [433] -1.43657870 -3.27884453 -4.03358574 -4.77186137 -2.77449360 -3.14135439
 [439] -0.77973084 -3.34034412 -3.02017029 -4.43121890 -3.41238790 -3.45269652
 [445] -1.08529774 -2.63737198 -1.78648889 -4.01973185 -2.19936252 -2.80907181
 [451] -4.25697448 -3.55385395 -3.42757054 -2.95425316 -2.35174525 -2.89100820
 [457] -1.65899904 -2.23801926 -2.02985084 -2.23696369 -2.00819333 -3.02556751
 [463] -3.69608845 -2.40394458 -2.99120588 -1.97586168 -0.89416076 -1.57183829
 [469] -3.82164965 -3.81806199 -3.70980999 -2.73839948 -3.92795460 -3.63416703
 [475] -1.95882202 -1.34795727 -3.31263137 -1.45102362 -2.37507508 -3.40821773
 [481] -5.16885073 -2.56057188 -4.78598969 -4.20860637 -2.90457231 -3.26579212
 [487] -3.11272469 -2.74256534 -4.61924171 -1.40371539 -2.42348922 -3.72444672
 [493] -0.87351756 -4.26121781 -3.59128991 -2.21491319 -1.86493347 -2.88158582
 [499] -1.61474647 -3.08951382 -3.87506434 -4.02825059 -3.29158017 -3.52501860
 [505] -3.28236131 -1.92966036 -1.77267735 -3.69849485 -2.69183341 -3.95377692
 [511] -2.88047664 -3.89277789 -2.57823900 -1.08250828 -3.28878818 -2.79076293
 [517] -3.17689171 -2.33743236 -4.63792297 -3.45623264 -3.96516322 -2.22938141
 [523] -4.33252003 -4.91877944 -3.76765591 -3.77986219 -2.87301389 -0.94906089
 [529] -2.69225235 -1.42045347 -2.12789859 -3.30368663 -1.98493196 -3.22856427
 [535] -2.14740444 -5.43126306 -3.40572388 -3.58996332 -3.34175091 -2.21417255
 [541] -4.13002858 -5.36532571 -4.46662572  0.41321212 -3.71360319 -1.99138770
 [547] -4.03808464 -2.52658975 -4.87173289 -4.41188317 -2.86336884 -4.44684385
 [553] -1.66826381 -2.47069520 -4.82664481 -2.71283314 -2.49356848 -3.37117465
 [559] -3.06678807 -2.96547730 -2.85015548 -2.67561904 -3.17901338 -2.32778094
 [565] -2.57549507 -2.64310720 -2.04423372 -2.08564741 -4.48728356 -4.03470589
 [571] -4.43372960 -3.22062562 -2.53569680 -4.52667232 -3.32159621 -1.53393704
 [577] -4.82667421 -2.83530798 -2.87081933 -3.43251012 -2.81768429 -1.62861173
 [583] -2.36180784 -2.94927468 -2.71892712 -2.42413704 -2.74831875 -2.39224091
 [589] -1.64934292 -2.58398718 -3.95503310 -4.18891207 -2.53029330 -2.14099375
 [595] -1.65589001 -2.79378630 -3.27339918 -2.35522607 -3.60678655 -4.44599664
 [601] -2.00167330 -2.18010508 -3.33076924 -0.46373255 -3.27628580 -3.16329634
 [607] -2.94446775 -3.67292788 -4.22778618 -2.76197365 -3.11239731 -2.20584262
 [613] -3.00514930 -5.15255728 -2.22743115 -4.23155079 -2.83228208 -2.28564793
 [619] -3.88797198 -3.25520258 -1.55416956 -2.56680743 -4.59405671 -3.72223558
 [625] -1.96593903 -4.69887217 -4.19358496 -3.12676959 -3.33929635 -3.16127989
 [631] -5.49462146 -0.85530686 -3.71622007 -3.35254450 -3.89366428 -4.46578588
 [637] -1.59288961 -2.73163070 -3.59803015 -3.13643899 -2.77536229 -2.40503725
 [643] -1.22151528 -1.88481750 -2.32786047 -2.28301301 -3.57102065 -2.02633875
 [649] -1.35040769 -3.88261843 -3.53022510 -1.71905540 -3.53092871 -2.84784697
 [655] -2.55492739 -2.27488960 -2.08164758 -4.08526366 -5.08935700 -3.19451905
 [661] -3.50220587 -5.14515221 -2.77557350 -3.54498201 -4.00419732 -3.82187999
 [667] -2.68810307 -1.80546325 -4.36814343 -2.44264989 -2.59314533 -4.25259618
 [673] -2.74040642 -4.09338414 -0.96177872 -2.12250211 -1.50878816 -1.23834114
 [679] -2.09125806 -1.81561541 -1.64862342 -3.31224894 -3.89259164 -3.04189706
 [685] -2.90397579 -3.28042822 -1.73818026 -2.17964202 -2.38771181 -4.47113791
 [691] -2.75628556 -2.80493899 -4.99766170 -2.83833908 -2.21113095 -3.24157418
 [697] -2.90290413 -2.70862656 -4.43952760 -4.18062170 -3.20313713 -1.30163305
 [703] -2.26403398 -2.36395215 -2.51376808 -3.71636033 -3.46900176 -0.99878199
 [709] -3.30138470 -4.41944800 -3.05750635 -1.05275016 -3.88971637 -4.55982229
 [715] -2.99609690 -3.60476408 -2.76766443 -1.12479176 -2.68709976 -3.41290368
 [721] -2.19455615 -1.67686226 -4.59868211 -1.43239597 -3.23068877 -1.82435146
 [727] -1.17232838 -2.91164635 -4.08973558 -2.31431335 -2.14961235 -3.26628084
 [733] -1.66530559 -3.56127812 -2.98235766 -1.71562850 -2.32790338 -2.39994550
 [739] -5.09116599 -4.28604843 -4.65122906 -3.32708506 -2.38941585 -2.85095228
 [745] -2.75338575 -1.10898232 -3.72745082 -2.74929381 -4.48202070 -2.49619707
 [751] -2.52906162 -2.89439429 -2.23923327 -2.75126106 -3.64938138 -1.86811023
 [757] -2.39762454 -4.09394397 -2.45657507 -2.32088246 -2.01172133 -2.92194964
 [763] -4.22313458 -2.97406568 -2.85750143 -3.46337250 -3.52921703 -1.98207677
 [769] -4.03786037 -3.21209271 -2.69556498 -3.24438388 -1.50647604 -3.86096013
 [775] -2.98599486 -0.84079914 -3.83048380 -1.32041770 -3.66177315 -1.96565723
 [781] -2.37527142 -1.99402247 -3.31338506 -2.33131690 -3.85951756 -3.01531134
 [787] -2.33692282 -3.86044949 -3.17813220 -1.23528322 -3.17187010 -2.24042363
 [793] -1.88433600 -1.32930653 -4.67147072 -3.73710923 -1.82883237 -4.45659746
 [799] -2.08848705 -2.01891173 -4.18111489 -3.90116349 -3.99986031 -2.99861991
 [805] -0.93139388 -2.56033725 -2.40834102 -3.76260413 -2.40834589 -4.09445766
 [811] -0.65120575 -3.91717968 -1.11441951 -3.10192541 -4.45627927 -3.28707367
 [817] -2.44782659 -2.99871859 -1.62180763 -3.25214846 -3.92913007 -3.34388813
 [823] -3.07580293 -2.89453511 -3.60169393 -3.38785245 -0.69793083 -2.89559873
 [829] -5.04882707 -3.57347560 -4.12179982 -3.02881633 -4.21999523 -2.93292804
 [835] -3.26755844 -2.41885105 -3.95838153 -1.70826209 -1.99712740 -1.94270426
 [841] -2.98850571 -3.86026990 -3.22493957 -2.79883354 -2.44916095 -3.50962343
 [847] -3.42822372 -2.83430657 -2.43089237 -3.59421377 -2.42630856 -2.39587667
 [853] -2.42032592 -3.58277720 -0.78010334 -3.73786896 -4.74290805 -4.04642215
 [859] -1.15321090 -2.33483363 -1.56263084 -2.54398484 -2.09846775 -3.65280954
 [865] -1.93669652 -3.38436841 -2.00405156 -1.91096587 -2.94233332 -1.56131684
 [871] -2.77246698 -4.58552090 -2.92173748 -1.68352415 -2.54023783 -1.73037903
 [877] -3.23791616 -2.03360059 -2.03285947 -3.84810754 -1.96756382 -3.00393212
 [883] -3.12198741 -1.80161145 -1.49244169 -1.49974173 -2.79261584 -1.86159141
 [889] -3.80164106 -3.71899899 -2.25792935 -2.15147298 -4.07054696 -3.32819006
 [895] -3.17396528 -1.97314561 -3.57924315 -0.96794708 -3.81302261 -3.00008998
 [901] -2.57002755 -2.23656817 -3.26585470 -1.47241553 -3.23098394 -5.21750803
 [907] -2.53527571 -2.35318905 -3.30254799 -1.49647851 -1.45772766 -1.37232506
 [913] -2.14639270 -2.13040707 -5.39393616 -2.27660970 -4.28290559 -1.57084730
 [919] -1.24524348 -2.33231506 -3.95254583 -3.88308400 -3.32434817 -2.62341136
 [925] -3.03010838 -2.23749134 -2.29060161 -3.78861346 -2.97742384 -3.38897551
 [931] -5.19946881 -4.08286005 -1.40147794 -1.44467158 -3.32184464 -4.79676969
 [937] -2.73279812 -1.98817540 -0.87963423 -3.68123467 -2.44556115 -2.50137959
 [943] -4.30582933 -2.59875155 -1.60771586 -2.12440735 -0.86476645 -3.23693227
 [949] -3.26274668 -1.85774637 -4.19522801 -1.94095806 -2.37489355 -3.78090282
 [955] -5.43531667 -1.76388076 -2.27660762 -3.76211383 -3.41953520 -3.17064329
 [961] -1.67561635 -6.03431773 -2.32971204 -4.75779560 -2.55434245 -2.40167902
 [967] -2.21512309 -4.17664806 -4.68521224 -3.02801767 -2.05747281 -3.62636357
 [973] -2.08891357 -2.85502079 -2.08335863 -1.66482870 -2.12992427 -3.00371071
 [979] -2.71215615 -3.78170554 -5.54877481 -1.62755005 -0.87805396 -2.97683160
 [985] -1.17110067 -4.36364448 -3.01339259 -4.01983259 -2.67701658 -4.94316250
 [991] -3.29500703 -1.04507377 -2.11455814 -3.34302091 -5.24454304 -3.37766931
 [997] -3.61837407 -2.53812792 -3.10275115 -5.40075350  3.66060446  1.44667711
[1003]  1.61093358  3.19135363  3.07225180  3.08859663  4.40821255  2.69002833
[1009]  2.26881741  2.00991762  3.25234869  3.36660495  4.34772066  4.39480739
[1015]  2.78974728  2.74825859  2.87330124  2.22192908  2.11806384  4.18494859
[1021]  2.65302157  1.63093321  3.54574088  3.92566268  3.66522858  3.18302859
[1027]  5.49609690  2.47790520  1.88125097  4.44833845  2.40278066  3.43102150
[1033]  3.34392533  2.73130469  3.27519873  3.80168230  3.67218118  4.52416299
[1039]  3.92152007  2.89526548  2.20580720  3.24159969  5.53700266  3.39428013
[1045]  2.17978154  3.72497826  0.79213020  1.50645414  0.63024553  3.84241625
[1051]  2.96254004  2.28184484  3.26017910  3.10743629  2.60136773  1.51411324
[1057]  4.22620281  2.46989821  3.18528782  2.58770777  5.29424960  2.73396922
[1063]  3.74660331  2.42052328  2.33246985  3.29794259  2.87525875  1.48020640
[1069]  3.33199015  2.81225184  4.09341645  3.08555060  2.17501100  3.69859184
[1075]  2.36754108  2.66066507  3.02517028  1.01091786  2.25959134  3.28143850
[1081]  0.73784032  3.26960868  3.36969218  1.93737278  3.49133682  1.53056090
[1087]  1.89991937  5.21472739  2.92134724  1.39261895  4.33885316  3.60771267
[1093]  1.66073605  2.97208937  4.20558781  3.93096008  3.21186181  2.50362968
[1099]  3.78349185  2.77410012  3.02182171  1.82349451  1.02025319  3.40107403
[1105]  1.79119861  3.36759496  3.83422706  2.72523190  3.24633646  3.40094275
[1111]  3.92931270  2.67013692  3.37877509  1.12892111  3.26909552  1.72719722
[1117]  3.09710668  3.59725641  0.23938245  1.27611205  2.99698438  2.04623572
[1123]  2.68934012  3.42969055  2.05989769  4.12500280  2.97752789  2.11746368
[1129]  3.73003324  3.37041055  3.34336810  3.90216215  4.22686562  3.81687463
[1135]  1.40490742  1.59924458  2.55490986  4.94043760  2.73488749  5.26018856
[1141]  2.09193811  3.03812963  3.82189088  2.09411310  3.76961338  2.50293567
[1147]  3.98066958  2.35702251  1.94137685  1.74595917  2.33223777  2.52357188
[1153]  3.89329103  2.21894745  4.17029441  4.58532978  1.78008954  2.94615592
[1159]  2.09124634  1.77689836  2.49688644  3.32902728  5.44555254  1.98941669
[1165]  2.23636118  4.48553241  2.50081956  1.93372963  4.17503058  2.07887346
[1171]  1.96471553  4.28835651  4.11968587  1.62412748  3.52165225  4.43074957
[1177]  2.14604695  3.02136063  1.77607886  0.58348132  2.13118759  3.61147975
[1183]  2.58336838  4.98505722  3.40679832  3.31749221  4.16738145  2.16503343
[1189]  3.07715237  2.74385955  2.29587550  1.16571179  2.05847959  3.15654461
[1195]  2.12423546  3.29010230  2.62177608  3.38849570  2.89383655  4.47638976
[1201]  3.00474460  1.78249610  3.33211453  2.43660043  3.16225472  2.50172103
[1207]  2.54387029  2.80029676  3.36218155  3.18177833  3.08195408  4.11509518
[1213]  4.91158566  2.31862700  3.19871831  3.15961769  1.70436640  3.68929822
[1219]  3.46860743  2.13332416  2.24479022  2.28933668  1.72373982  2.53464041
[1225]  2.39151792  3.33588792  1.65230982  3.95607273  4.10390932  2.02213727
[1231]  4.20170465  3.23708932  4.62259163  3.26851014  1.32122729  3.36000097
[1237]  1.95943326  2.24395255  2.74625218  3.52367744  3.39669135  2.76057289
[1243]  2.20449028  2.32902026  1.10614561  3.39664743  5.76577018  2.97590453
[1249]  2.33995221  3.45387564  2.66710942  3.10274685  2.47180624  2.36308016
[1255]  1.69798777  2.53471397  4.58411514  2.14354481  2.42659506  0.20128890
[1261]  4.22050009  3.98152953  1.50843080  2.64302474  4.04260922  2.43757157
[1267]  3.50223465  3.64782614  2.38839068  2.93983308  2.54112174  4.22466751
[1273]  2.88705073  1.63923132  1.57611783  3.19511889  2.82746126  4.58947051
[1279]  1.51101939  2.85962741  2.94514150  3.05297994  2.95317861  3.02894152
[1285]  4.36015088  1.97528611  2.90979741  5.06665745  2.79212052  2.42251155
[1291]  3.25864342  2.28893465  2.66345754  2.37211443  4.45930431  3.80297177
[1297]  3.48844188  2.79140411  0.51006834  3.35190477  4.25396539  2.48765149
[1303]  2.39855878  3.53067512  2.23597280  4.55109748  3.58247292  1.91166108
[1309]  1.52970208  2.52631596  3.78514926  4.25979272  3.33854789  3.83430806
[1315]  3.54819432  2.57070117  2.82521505  0.44468064  3.65827099  4.59086590
[1321]  2.49928951  1.38163468  2.62829923  2.06985635  3.25008100  3.40089512
[1327]  2.83428572  4.04448053  3.04438593  2.38073542  3.44947017  3.61974119
[1333]  4.33669148  3.71702514  0.39946793  3.41661133  1.50160596  4.20411789
[1339]  2.57338423  3.31672071  1.56611008  2.25636476  1.44059457  1.58864054
[1345]  3.30442734  0.94482149  3.60315572  3.34264119  5.16347313  3.34708359
[1351]  3.65598233  1.64392816  4.31681448  2.81535063  3.52144802  2.81668247
[1357]  3.62473160  3.40459947  2.17395560  3.36022924  0.57019279  4.19840905
[1363]  1.26047037  4.53436649  2.98832351  1.47380553  0.73521821  1.09746420
[1369]  1.70217018  2.66216637  3.13004442  3.32499855  3.56514213  1.93327097
[1375]  4.14577803  2.78303749  3.75052445  3.16136098  4.46359939  3.92147617
[1381]  4.56210583  2.44433940  2.91432238  2.66067123  3.41033849  3.05715656
[1387]  2.71653625  1.63749396  2.82726183  4.85429032  1.90837618  3.65796305
[1393]  3.29011645  3.27804274  3.13653192  2.99200330  4.03558129  0.86684144
[1399]  4.69672957  1.66893849  3.24586821  4.21417455  2.87131633  2.50841967
[1405]  3.70404279  3.17972025  2.21300388  3.12437449  3.11721427  2.62815072
[1411]  1.84357116  2.51695524  3.69681021  1.42108973  4.43016951  2.74128136
[1417]  2.69475936  4.82345832  4.68649464  3.88604992  3.45078537  4.90581431
[1423]  2.11020759  4.21397619  4.26236144  2.02470406  3.33198468  2.25422915
[1429]  1.86086588  2.04987432  4.07200910  2.40401995  1.64079172  3.01848327
[1435]  2.31825275  3.64850079  4.96137227  3.02862218  2.51010587  2.97725905
[1441]  2.29748331  2.31165899  4.02418077  3.89255731  3.60852687  3.25823788
[1447]  3.42453349  3.04899034  2.80977696  3.32501865  3.17974490  1.89322545
[1453]  4.61651491  3.05352164  1.77172220  1.65527832  2.52889703  2.93905585
[1459]  2.80253907  3.23637584  3.37321860  2.59330560  4.33986003  1.11640085
[1465]  1.11033335  3.04908773  2.63984340  3.13600209  4.18993159  1.71068485
[1471]  3.24929868  1.53126771  2.65680570  2.50664829  4.37100013  3.51193347
[1477]  3.13554134  4.90810461  1.53949647  2.00945692  2.97159135  4.27269151
[1483]  2.59613687  3.27020708  3.34305776  2.77495857  1.69043700  3.03200553
[1489]  3.16182239  3.14314491  4.32531631  2.09015483  3.76483350  1.39069095
[1495]  1.95417302  2.67153786  1.41721258  2.05860696  3.36781331  1.85270902
[1501]  2.64009385  3.34328575  4.48907981  4.02841500  2.65178674  2.33361239
[1507]  2.50274304  3.13616147  2.19509894  4.65673481  1.70851073  3.81134886
[1513]  4.53922352  3.51019265  2.97211556  4.50624137  3.96729282  3.34181193
[1519]  2.58945901  5.14621192  2.57970750  2.14516215  1.90254628  1.74958637
[1525]  3.64525602  2.50032189  2.64714589  3.78312041  2.51380842  4.48748537
[1531]  3.33931141  4.47165638  1.61140825  2.32228408  2.35584124  3.70490001
[1537]  2.77558392  4.00566192  2.58219380  4.61924607  3.25301989  3.53057824
[1543]  2.99491587  2.34946432  1.79056706  3.78353682  1.80530607  2.73522640
[1549]  4.08421563  3.50477169  3.37310592  2.09107915  2.77309650  3.33104967
[1555]  4.49362012  3.25634573  2.23488562  4.26167591  2.81123586  2.31193793
[1561]  2.99087526  2.24476436  3.61299424  5.15729782  1.35188984  2.80823383
[1567]  0.49895276  4.36332076  4.83367021  1.39167198  4.17047520  2.16247996
[1573]  1.74996088  2.94013575  3.43729252  5.15597002  3.51956229  3.84958156
[1579]  3.01427587  1.68182319  4.84876692  3.43253436  3.44470391  1.77943893
[1585]  2.39084169  3.00419328  1.74502201  2.63726992  1.75598648  4.32300568
[1591]  2.43207745  2.84061953  3.46883382  3.22749281  3.41668096  2.16548322
[1597]  2.94281597  1.51326616  4.15143401  3.49870445  3.59743453  2.32005082
[1603]  3.13850832  1.80035173  2.30728827  2.51832558  2.13566988  1.04053139
[1609]  3.40047945  3.17454709  1.48039504  2.83642171  2.22390434  4.77850149
[1615]  2.81098084  2.16492917  3.24106522  4.25089951  4.19823911  4.74693967
[1621]  3.42577211  1.61887543  3.35433186  0.58913061  2.08576871  1.47084992
[1627]  2.16894543  2.30471257  3.40638809  1.96892051  2.37916458  1.91362493
[1633]  2.41477324  3.48808679  2.31447672  3.62491050  2.98387311  3.49999135
[1639]  4.06299375  3.00713708  2.32044568  1.82890715  3.91880961  2.40968811
[1645]  4.19979797  3.51466437  2.24037521  2.35348525  2.67745175  3.52906031
[1651]  3.98939945  2.65291107  3.21725344  4.01512861  2.84167972  2.92840135
[1657]  2.02923613  4.38528993  2.01565912  5.00681930  3.31115282  1.98128474
[1663]  4.02920010  4.37966265  3.24979032  4.52558781  3.80949286  3.68316824
[1669]  2.75766921  2.70338093  3.90166427  5.67767849  2.30694215  2.43243876
[1675]  1.82096940  3.54475551  2.13238709  2.61192042  4.49563959  4.18581043
[1681]  1.76055595  3.59030459  2.96051586  4.03008323  3.30442639  1.95954079
[1687]  3.00124898  3.92724192  1.23420514  3.05326184  3.85655231  2.79431448
[1693]  1.31098439  3.37595937  2.36833903  3.52725371  3.97712813  3.12999333
[1699]  3.03798332  2.35227684  5.12725430  2.87351185  2.36456917  3.48799984
[1705]  2.15828215  3.84923796  3.00105527  3.40893152  1.25618098  2.51710553
[1711]  3.63440262  3.22091042  3.03184163  1.93230173  3.05615964  3.56261702
[1717]  2.63484130  2.62411008  3.46131445  2.82430003  3.21204234  3.81887250
[1723]  3.40295915  3.00327414  2.67321124  3.85673411  3.11694435  1.89926912
[1729]  3.70022091  3.03534665  3.76944223  3.51512330  4.50713971  2.20732286
[1735]  2.54552827  3.71043803  3.33559130  3.93480605  5.60214426  4.33853316
[1741]  3.90108695  3.40793513  3.17866475  2.73932763  3.21233369  2.64084358
[1747]  4.64813370  4.61780980  4.13133565  2.42162978  3.78894875  3.93026721
[1753]  2.93471790  2.13414278  2.93038468  2.81388693  3.78447232  1.77639565
[1759]  1.13489412  2.28224763  2.41009889  3.22647748  3.78926554  2.76198287
[1765]  3.03774207  2.77229536  2.82947473  1.62548816  2.91172775  1.78509683
[1771]  3.25124799  2.54945193  1.44654679  4.19723986  2.41979341  3.97591869
[1777]  3.60656127  1.39403634  3.51271954  3.81586037  2.00969364  4.54635213
[1783]  4.25257570  3.29548436  4.12350746  1.76776722  3.92824744  2.74364110
[1789]  3.83475629  2.71281687  3.56542391  1.22698226  3.83885975  4.07250851
[1795]  2.12624778  1.63900017  4.33420924  2.83074853  3.38388510  3.18144839
[1801]  3.02650867  3.69545174  6.12295880  3.27173276  2.73355837  2.24054247
[1807]  5.09059316  4.16248334  3.37103662  3.10807285  2.43828505  2.95069957
[1813]  1.13633299  4.00718264  3.84803165  1.80143690  1.74088491  1.02605016
[1819]  2.36876935  4.65425950  2.08607526  2.55162713  3.19339126  1.62971889
[1825]  3.36703651  2.67148194  2.06375918  3.51857706  3.59268275  3.69380065
[1831]  4.06539563  3.48729824  2.08637855  2.51942098  1.92098947  2.86012003
[1837]  6.51412621  2.74100379  1.78239869  3.29825058  3.21334854  2.70100604
[1843]  4.00302479  3.16746794  5.45321229  3.42771067  3.75529385  1.83933474
[1849]  2.87435974  2.73369185  2.10103707  2.95268228  2.41757545  4.09274798
[1855]  4.09893904  0.81314786  3.66570053  4.26327971  1.72698420  2.06607070
[1861]  3.55098362  4.12746232  3.81774403  2.77440149  3.31654327  3.25858905
[1867]  3.21781677  3.20009867  2.11501059  4.32185591  3.98742995  2.98012923
[1873]  3.56340977  2.23523850  3.38129442  3.13978691  3.50626144  2.10095882
[1879]  3.48094594  4.75379622  4.33975049  0.64048582  3.28881859  5.01654714
[1885]  2.73843024  4.64869475  3.41077110  2.56291840  2.65443904  1.78514041
[1891]  3.47631358  3.93171039  1.25056476  1.28600716  2.82631037  3.11234267
[1897]  1.82950335  3.53754532  3.64180245  4.80341006  0.94922777  3.34275376
[1903]  4.04178601  2.79005834  2.85530374  2.34560936  4.51598252  1.68414871
[1909]  3.93638636  3.39894179  1.78075671  0.84270977  2.62093026  3.00128279
[1915]  1.40279352  2.91506936  1.14810062  3.06732613  2.83914905  2.83744546
[1921]  3.73526790  2.87414094  4.19698940  4.97626047  3.33548196  1.91630028
[1927]  2.28465840  3.19664779  2.03576994  3.41271392  3.25683480  3.79192458
[1933]  2.50682820  3.14162046  3.36021593  2.61190181  2.12581698  3.50360678
[1939]  3.66465753  2.83806888  4.50055109  5.17501503  3.09911428  3.19314128
[1945]  3.90261010  3.56378687  4.28979155  3.62759945  3.39757420  1.69457231
[1951]  2.88710822  1.98252456  3.32492663  3.50433258  3.77320100  3.13816503
[1957]  2.92817313  2.59356126  4.31351361  4.34572364  1.38167177  2.46763400
[1963]  1.72723834  3.21766272  3.19755221  4.60268385  2.73248207  3.99704213
[1969]  2.77588254  2.54498172  2.27867715  3.84689445  3.71316259  1.68813816
[1975]  0.88903720  2.81709181  2.62704391  2.82954817  1.90219085  3.50475241
[1981]  2.83874742  4.22026686  4.24277010  1.81977418  2.93371236  1.71999145
[1987]  1.73981616  4.09664414  2.35210169  1.00388091  1.96176285  1.60712523
[1993]  2.20230693  3.04622938  4.33593133  2.33659965  2.72075265  4.11171634
[1999]  3.95896785  2.87933828</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">30</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="sc">-</span><span class="dv">3</span>), <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">3</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rev</span>(x)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x, y)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               x          y
 [1,] -1.6118826  3.0410581
 [2,] -2.3387902  3.0287730
 [3,] -1.4256020  4.0706445
 [4,] -1.5181623  3.6362083
 [5,] -2.9961805  1.3156014
 [6,] -3.8682204  1.0390596
 [7,] -2.6309386  2.2296253
 [8,] -4.6037168  4.2768171
 [9,] -4.8687481  3.2413470
[10,] -2.4928547  3.7348049
[11,] -1.9680652  1.8037392
[12,] -5.1830138  1.0939681
[13,] -1.9487897  3.2009823
[14,] -4.3824931  3.1397442
[15,] -4.2045066  1.4014940
[16,] -3.4632770  3.3451021
[17,] -2.2150803  2.7029308
[18,] -1.1823720  2.8343279
[19,] -3.6449884  3.8811572
[20,] -3.4096316  4.2052463
[21,] -1.4573845  1.7879371
[22,] -0.5770336  2.6075291
[23,] -2.4642799  0.9311129
[24,] -2.5826047  3.1980492
[25,] -4.0450035  2.8626220
[26,] -2.5164109  3.7855823
[27,] -2.4958464  0.8738512
[28,] -3.6655793  1.8213837
[29,] -4.1092484  3.2203557
[30,] -2.4592543  3.4671254
[31,]  3.4671254 -2.4592543
[32,]  3.2203557 -4.1092484
[33,]  1.8213837 -3.6655793
[34,]  0.8738512 -2.4958464
[35,]  3.7855823 -2.5164109
[36,]  2.8626220 -4.0450035
[37,]  3.1980492 -2.5826047
[38,]  0.9311129 -2.4642799
[39,]  2.6075291 -0.5770336
[40,]  1.7879371 -1.4573845
[41,]  4.2052463 -3.4096316
[42,]  3.8811572 -3.6449884
[43,]  2.8343279 -1.1823720
[44,]  2.7029308 -2.2150803
[45,]  3.3451021 -3.4632770
[46,]  1.4014940 -4.2045066
[47,]  3.1397442 -4.3824931
[48,]  3.2009823 -1.9487897
[49,]  1.0939681 -5.1830138
[50,]  1.8037392 -1.9680652
[51,]  3.7348049 -2.4928547
[52,]  3.2413470 -4.8687481
[53,]  4.2768171 -4.6037168
[54,]  2.2296253 -2.6309386
[55,]  1.0390596 -3.8682204
[56,]  1.3156014 -2.9961805
[57,]  3.6362083 -1.5181623
[58,]  4.0706445 -1.4256020
[59,]  3.0287730 -2.3387902
[60,]  3.0410581 -1.6118826</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class7_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="k-means-clustering" class="level2">
<h2 class="anchored" data-anchor-id="k-means-clustering">K-means clustering</h2>
<p>The function in base R for k-means clustering is called <code>kmeans()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>km <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(z, <span class="at">centers =</span> <span class="dv">2</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>km</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-means clustering with 2 clusters of sizes 30, 30

Cluster means:
          x         y
1 -2.877665  2.725939
2  2.725939 -2.877665

Clustering vector:
 [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2
[39] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2

Within cluster sum of squares by cluster:
[1] 72.77721 72.77721
 (between_SS / total_SS =  86.6 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>km<span class="sc">$</span>centers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          x         y
1 -2.877665  2.725939
2  2.725939 -2.877665</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q. Print out the membership factor (i.e.&nbsp;our main answer)</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>km<span class="sc">$</span>cluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2
[39] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(z, <span class="at">centers =</span> <span class="dv">2</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(z, <span class="at">col =</span> cl<span class="sc">$</span>cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class7_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(z, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class7_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#points(cl$centers, col = 1:5, pch = 8)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#color by number</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(z, <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class7_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>plot with clustering result</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(z, <span class="at">col =</span> cl<span class="sc">$</span>cluster)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(cl<span class="sc">$</span>centers, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">pch =</span> <span class="dv">17</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class7_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Q. Can you cluster our data i <code>z</code> into four clusters</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(z, <span class="at">centers =</span> <span class="dv">4</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(z, <span class="at">col =</span> cl<span class="sc">$</span>cluster)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(cl<span class="sc">$</span>centers, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">pch =</span> <span class="dv">17</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class7_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>##Hierarchical Clustering</p>
<p>The main funtion for hierarchical clustering in base R is called <code>hclust()</code></p>
<p>Unlike K-means (<code>kmeans</code>) I can not just pass mu data as input, first I need a distance matirx from my data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">dist</span>(z)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(d)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>hc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
hclust(d = d)

Cluster method   : complete 
Distance         : euclidean 
Number of objects: 60 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hc)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">10</span>, <span class="at">col =</span> <span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class7_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>TO get my clustering results (i.e.&nbsp;the membership vector), I can “cut” my tree/dendrogram at a given eight. To do this I will use the <code>cutree()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>grps <span class="ot">&lt;-</span> <span class="fu">cutree</span>(hc, <span class="at">h =</span><span class="dv">10</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(z, <span class="at">col =</span> grps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class7_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="principle-component-analysis" class="level1">
<h1>Principle Component Analysis</h1>
<p>Principal component analysis (PCA) is a well established “multivariate statistical technique” used to reduce the dimensionality of a complex data set to a more manageable number (typically 2D or 3D). This method is particularly useful for highlighting strong paterns and relationships in large datasets (i.e.&nbsp;revealing major similarities and diferences) that are otherwise hard to visualize. As we will see again and again in this course PCA is often used to make all sorts of bioinformatics data easy to explore and visualize.</p>
<section id="pca-of-uk-food-data" class="level2">
<h2 class="anchored" data-anchor-id="pca-of-uk-food-data">PCA of UK food data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">"https://tinyurl.com/UK-foods"</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Q1. How many rows and columns are in your new data frame named x? # What R functions could you use to answer this questions?</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17  5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#gives number of rows &amp; columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Preview the first 6 rows</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(x, <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               X England Wales Scotland N.Ireland
1         Cheese     105   103      103        66
2  Carcass_meat      245   227      242       267
3    Other_meat      685   803      750       586
4           Fish     147   160      122        93
5 Fats_and_oils      193   235      184       209
6         Sugars     156   175      147       139</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note how the minus indexing works</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(x) <span class="ot">&lt;-</span> x[,<span class="dv">1</span>]</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> x[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               England Wales Scotland N.Ireland
Cheese             105   103      103        66
Carcass_meat       245   227      242       267
Other_meat         685   803      750       586
Fish               147   160      122        93
Fats_and_oils      193   235      184       209
Sugars             156   175      147       139</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17  4</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(url, <span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               England Wales Scotland N.Ireland
Cheese             105   103      103        66
Carcass_meat       245   227      242       267
Other_meat         685   803      750       586
Fish               147   160      122        93
Fats_and_oils      193   235      184       209
Sugars             156   175      147       139</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q2. Which approach to solving the ‘row-names problem’ mentioned above do you prefer and why? Is one approach more robust than another under certain circumstances?</p>
</blockquote>
<p>I prefer ‘x &lt;- read.csv(url, row.names=1)’ as the other methods keeps on overwritting the rownames as the next column on the left and we loose the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">as.matrix</span>(x), <span class="at">beside=</span>F, <span class="at">col=</span><span class="fu">rainbow</span>(<span class="fu">nrow</span>(x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class7_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(x, <span class="at">col=</span><span class="fu">rainbow</span>(<span class="dv">10</span>), <span class="at">pch=</span><span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class7_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The plot here gives matrix kind of plots where each plot is a scatter plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pca-to-the-rescue" class="level2">
<h2 class="anchored" data-anchor-id="pca-to-the-rescue">PCA to the rescue</h2>
<p>The main function to do PCA in base R is called <code>prcomp</code></p>
<p>Note that I need to take the transpose of this particular data as that is what <code>prcomp()</code> help page was asking for</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(<span class="fu">t</span>(x))</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                            PC1      PC2      PC3       PC4
Standard deviation     324.1502 212.7478 73.87622 3.176e-14
Proportion of Variance   0.6744   0.2905  0.03503 0.000e+00
Cumulative Proportion    0.6744   0.9650  1.00000 1.000e+00</code></pre>
</div>
</div>
<p>Let’s see what is inside our result object <code>pca</code> that we just calculated:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$names
[1] "sdev"     "rotation" "center"   "scale"    "x"       

$class
[1] "prcomp"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>pca<span class="sc">$</span>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 PC1         PC2        PC3           PC4
England   -144.99315   -2.532999 105.768945 -4.894696e-14
Wales     -240.52915 -224.646925 -56.475555  5.700024e-13
Scotland   -91.86934  286.081786 -44.415495 -7.460785e-13
N.Ireland  477.39164  -58.901862  -4.877895  2.321303e-13</code></pre>
</div>
</div>
<p>To make our main result figure, called a “PC plot” (or “score plot”, “ordination plot”, or “PC1 vs PC2 plot”)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pca<span class="sc">$</span>x[,<span class="dv">1</span>], pca<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"darkgreen"</span>), <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">xlab=</span><span class="st">"PC1 (67.4%)"</span>, <span class="at">ylab=</span><span class="st">"PC2 (29.0%)"</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">270</span>,<span class="dv">500</span>))</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(pca<span class="sc">$</span>x[,<span class="dv">1</span>], pca<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="fu">colnames</span>(x))</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col=</span><span class="st">"gray"</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">0</span>, <span class="at">col=</span><span class="st">"gray"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class7_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="variable-loadings-plot" class="level2">
<h2 class="anchored" data-anchor-id="variable-loadings-plot">Variable loadings plot</h2>
<p>can give us insights on how original varibales in</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Lets focus on PC1 as it accounts for &gt; 90% of variance </span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">3</span>, <span class="fl">0.35</span>, <span class="dv">0</span>))</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>( pca<span class="sc">$</span>rotation[,<span class="dv">1</span>], <span class="at">las=</span><span class="dv">2</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class7_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>pca<span class="sc">$</span>rotation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             PC1          PC2         PC3          PC4
Cheese              -0.056955380  0.016012850  0.02394295 -0.694538519
Carcass_meat         0.047927628  0.013915823  0.06367111  0.489884628
Other_meat          -0.258916658 -0.015331138 -0.55384854  0.279023718
Fish                -0.084414983 -0.050754947  0.03906481 -0.008483145
Fats_and_oils       -0.005193623 -0.095388656 -0.12522257  0.076097502
Sugars              -0.037620983 -0.043021699 -0.03605745  0.034101334
Fresh_potatoes       0.401402060 -0.715017078 -0.20668248 -0.090972715
Fresh_Veg           -0.151849942 -0.144900268  0.21382237 -0.039901917
Other_Veg           -0.243593729 -0.225450923 -0.05332841  0.016719075
Processed_potatoes  -0.026886233  0.042850761 -0.07364902  0.030125166
Processed_Veg       -0.036488269 -0.045451802  0.05289191 -0.013969507
Fresh_fruit         -0.632640898 -0.177740743  0.40012865  0.184072217
Cereals             -0.047702858 -0.212599678 -0.35884921  0.191926714
Beverages           -0.026187756 -0.030560542 -0.04135860  0.004831876
Soft_drinks          0.232244140  0.555124311 -0.16942648  0.103508492
Alcoholic_drinks    -0.463968168  0.113536523 -0.49858320 -0.316290619
Confectionery       -0.029650201  0.005949921 -0.05232164  0.001847469</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Lets focus on PC1 as it accounts for &gt; 90% of variance </span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">3</span>, <span class="fl">0.35</span>, <span class="dv">0</span>))</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>( pca<span class="sc">$</span>rotation[,<span class="dv">1</span>], <span class="at">las=</span><span class="dv">2</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class7_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>